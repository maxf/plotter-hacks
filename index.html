<!DOCTYPE HTML>
<html>
  <head>
    <title>Celtic</title>
    <script src="celtic.js"></script>
    <style>
     body {
       margin: 0;
       font-family: sans;
     }
     #canvas {
       width: 100vw;
       height: 100vh;
     }
     #controls {
       position: absolute;
       top: 0;
       background: #ddd;
     }
    </style>
  </head>
  <body>
    <svg id="canvas"></svg>
    <div id="controls">
      <select id="graph-type">
        <option>Polar</option>
        <option>Grid</option>
      </select><br/>
      <input id="shape1" type="range" min="-2" max="2" step="0.01" /> shape1: <span id="shape1-value"></span><br/>
      <input id="shape2" type="range" min="-2" max="2" step="0.01" /> shape2: <span id="shape2-value"></span><br/>
      <input id="nbOrbits" type="range" min="0" max="20" step="1" /> nbOrbits: <span id="nbOrbits-value"></span><br/>
      <input id="nbNodesPerOrbit" type="range" min="4" max="20" step="1" /> nbNodesPerOrbits: <span id="nbNodesPerOrbit-value"></span><br/>
      <input id="cells" type="range" min="1" max="100" step="1" /> cells: <span id="cells-value"></span><br/>
    </div>

    <script>
     const $ = id => document.getElementById(id);

     var canvas = $("canvas");
     var rect = canvas.getBoundingClientRect();
     let width = rect.width;
     let height = rect.height;
     let shape1 = 1;
     let shape2 = -1.2;
     let graphType = 'Polar';
     let nbOrbits = 4;
     let nbNodesPerOrbit = 6;
     let cells = 10;
     $('shape1').value = shape1;
     $('shape2').value = shape2;
     $('graph-type').value = graphType;
     $('nbOrbits').value = nbOrbits;
     $('nbNodesPerOrbit').value = nbNodesPerOrbit;
     $('cells').value = cells;
     $('shape1-value').innerText = shape1;
     $('shape2-value').innerText = shape2;
     $('nbOrbits-value').innerText = nbOrbits;
     $('nbNodesPerOrbit-value').innerText = nbNodesPerOrbit;

     const go = () => {
       const params = {
         width,
         height,
         shape1,
         shape2,
         graphType,
         nbOrbits,
         nbNodesPerOrbit,
         cells,
       };
       console.log(params);
       $('canvas').outerHTML = celticDraw(params);
     }
     go();


     const fetchParamsAndRun = () => {
       graphType = $('graph-type').value;
       shape1 = parseFloat($('shape1').value);
       shape2 = parseFloat($('shape2').value);
       nbOrbits = parseInt($('nbOrbits').value);
       nbNodesPerOrbit = parseInt($('nbNodesPerOrbit').value);
       cells = parseInt($('cells').value);

       $('shape1-value').innerText = shape1;
       $('shape2-value').innerText = shape2;
       $('nbOrbits-value').innerText = nbOrbits;
       $('nbNodesPerOrbit-value').innerText = nbNodesPerOrbit;
       $('cells-value').innerText = cells;
       go()
     }

     $('shape1').addEventListener('change', fetchParamsAndRun);
     $('shape2').addEventListener('change', fetchParamsAndRun);
     $('graph-type').addEventListener('change', fetchParamsAndRun);
     $('nbOrbits').addEventListener('change', fetchParamsAndRun);
     $('nbNodesPerOrbit').addEventListener('change', fetchParamsAndRun);
     $('cells').addEventListener('change', fetchParamsAndRun);
    </script>
  </body>
</html>
